> Blockchain Technology and Application Lab 2 Report
>
> 郭耸霄 PB20111712

[TOC]

在本次实验中，我记录了如下问题及其解决方案：

#### Apr 28 13:30

问题 0：SPV 路径冗余。将本不需要加入 SPV 的结点（包括根结点和叶子结点）也试图加入其中，使得编写生成 SPV 的代码过于繁琐以致无法进行。

解决方案 0：正确认识 SPV 后，采用类似进栈出栈方式完成了算法的实现。

#### Apr 28 13:45

问题 1：步骤 1 校验错误，每个结点的哈希值都是对的，生成的 Merkle 树也是正确的，SPV 路径生成也正确，但是验证路径错误。

解决方案 1：实际上是因为 Merkle 树存储的是未哈希的数据，将叶子结点的数据哈希后，验证通过。

#### Apr 28 14:03

问题 2：对 0 号结点的 SPV 生成与验证通过，但是对 1 号、2 号结点失败。

解决方案 2：二叉树选择孩子的方式错误。应该将`index`从高位向地位判断是 0 还是 1 来选择左孩子与右孩子，而不是从低位向高位。 

#### Apr 29 17:46

问题 3：wallet_test.go `expected` 与 `actual` 顺序错误。

解决方案 3：将语句中两值调换位置，此处为代码框架错误。

#### Apr 29 17:58

问题 4：钱包地址生成时前面多出若干位。

解决方案 4：将`version`转成`int64`，导致前面多补充了若干 0。应该转为`int8`。

#### Apr 29 18:08

问题 5：钱包地址生成时后面几个字节错误。

解决方案 5：根据搜索的资料，==计算公钥哈希的双重哈希时，需要在前面增加版本号，此处为实验文档错误==。

#### Apr 29 20:58

问题 6：`lock`的结果全为 0。

解决方案 6：对`lock`的作用理解有误，当做需要`encode`。改为`decode`后便通过了检验。
